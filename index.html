<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÛŒØ³ØªÙ… Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø´Ø§Ù†Ø³</title>
    <style>
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø±Ùˆ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯ */
        body {
            font-family: Tahoma, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: white;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            color: #333;
        }
        .btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
        }
        .btn-success { background: #27ae60; }
        .btn-warning { background: #f39c12; }
        .qr-container { margin: 20px 0; padding: 20px; border: 2px dashed #ddd; border-radius: 10px; }
    </style>
    <!-- Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ QRCode.js -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ Ù…Ø¯ÛŒØ±ÛŒØª Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø´Ø§Ù†Ø³</h1>
        <button class="btn" onclick="generateQR()">ØªÙˆÙ„ÛŒØ¯ QR Ú©Ø¯ Ø¬Ø¯ÛŒØ¯</button>
        
        <div class="qr-container">
            <div id="qrCode"></div>
            <div id="qrInfo"></div>
        </div>
    </div>

    <script>
        function generateQR() {
            const qrId = 'QR_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6);
            const qrUrl = window.location.href.split('?')[0] + '?qr=' + qrId;
            
            document.getElementById('qrCode').innerHTML = '';
            document.getElementById('qrInfo').innerHTML = '';
            
            // ØªÙˆÙ„ÛŒØ¯ QR Ú©Ø¯ Ø¨Ø§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡
            QRCode.toCanvas(document.getElementById('qrCode'), qrUrl, {
                width: 200,
                margin: 2,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            }, function (error) {
                if (error) {
                    // Ø§Ú¯Ø± Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ú©Ø§Ø± Ù†Ú©Ø±Ø¯ØŒ Ø§Ø² Ø±ÙˆØ´ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†
                    fallbackQR(qrUrl, qrId);
                } else {
                    // Ø§Ú¯Ø± Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ú©Ø§Ø± Ú©Ø±Ø¯
                    showQRInfo(qrId, qrUrl);
                }
            });
        }

        function fallbackQR(qrUrl, qrId) {
            // Ø±ÙˆØ´ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Canvas Ø¯Ø³ØªÛŒ
            const canvas = document.createElement('canvas');
            canvas.width = 200;
            canvas.height = 200;
            const ctx = canvas.getContext('2d');
            
            // Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ø³ÙÛŒØ¯
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, 200, 200);
            
            // Ø±Ø³Ù… QR Ú©Ø¯ Ø³Ø§Ø¯Ù‡ (Ù…Ø±Ø¨Ø¹â€ŒÙ‡Ø§ÛŒ Ù…Ø´Ú©ÛŒ)
            ctx.fillStyle = '#000000';
            for (let i = 0; i < 100; i++) {
                if (Math.random() > 0.5) {
                    const x = Math.floor(Math.random() * 18) * 10 + 10;
                    const y = Math.floor(Math.random() * 18) * 10 + 10;
                    ctx.fillRect(x, y, 8, 8);
                }
            }
            
            document.getElementById('qrCode').appendChild(canvas);
            showQRInfo(qrId, qrUrl);
        }

        function showQRInfo(qrId, qrUrl) {
            document.getElementById('qrInfo').innerHTML = `
                <div style="margin-top: 15px; padding: 10px; background: #e8f5e8; border-radius: 5px;">
                    <p><strong>Ø´Ù†Ø§Ø³Ù‡:</strong> ${qrId}</p>
                    <p><strong>Ù„ÛŒÙ†Ú©:</strong> <br><small>${qrUrl}</small></p>
                    <button class="btn btn-success" onclick="downloadQR()">ğŸ“¥ Ø°Ø®ÛŒØ±Ù‡ QR Ú©Ø¯</button>
                    <button class="btn btn-warning" onclick="printQR()">ğŸ–¨ï¸ Ú†Ø§Ù¾ QR Ú©Ø¯</button>
                </div>
            `;
        }

        function downloadQR() {
            const canvas = document.querySelector('#qrCode canvas');
            if (canvas) {
                const link = document.createElement('a');
                link.download = 'QR-Code-' + Date.now() + '.png';
                link.href = canvas.toDataURL();
                link.click();
            } else {
                alert('Ù„Ø·ÙØ§Ù‹ Ø§ÙˆÙ„ QR Ú©Ø¯ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯');
            }
        }

        function printQR() {
            const canvas = document.querySelector('#qrCode canvas');
            if (!canvas) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø§ÙˆÙ„ QR Ú©Ø¯ ØªÙˆÙ„ÛŒØ¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const printWindow = window.open('', '_blank');
            const qrImage = canvas.toDataURL();
            
            printWindow.document.write(`
                <html dir="rtl">
                <head><title>Ú†Ø§Ù¾ QR Ú©Ø¯</title></head>
                <body style="text-align: center; font-family: Tahoma; padding: 50px;">
                    <h1>ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù…Ø§</h1>
                    <h2>QR Ú©Ø¯ Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø´Ø§Ù†Ø³</h2>
                    <img src="${qrImage}" style="width: 300px; height: 300px; border: 3px solid #333;">
                    <p>Ø§ÛŒÙ† QR Ú©Ø¯ Ø±Ø§ Ø§Ø³Ú©Ù† Ú©Ù†ÛŒØ¯ Ùˆ Ø¯Ø± Ú¯Ø±Ø¯ÙˆÙ†Ù‡ Ø´Ø§Ù†Ø³ Ø´Ø±Ú©Øª Ú©Ù†ÛŒØ¯</p>
                    <p>ØªØ§Ø±ÛŒØ®: ${new Date().toLocaleDateString('fa-IR')}</p>
                    <hr>
                    <small>Ù‡Ø± QR Ú©Ø¯ ÙÙ‚Ø· ÛŒÚ©Ø¨Ø§Ø± Ù‚Ø§Ø¨Ù„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³Øª</small>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.print();
        }
    </script>
</body>
</html>
